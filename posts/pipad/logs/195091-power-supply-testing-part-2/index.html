<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pipad: Power supply testing, part 2 | Evan Krall</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Pipad: Power supply testing, part 2</span></h1>

<h2 class="date">2021/07/08</h2>
</div>

<main>
<p><em>View or comment on this project log on <a href="https://hackaday.io/project/177256/log/195091-power-supply-testing-part-2">Hackaday.io</a></em></p>

<p>I assembled the front of my board yesterday (dealing with 0402 components is tedious. I really should just pay JLCPCB to solder on most of the passives for me.) Today, I wanted to quickly test the power supply to make sure I hadn't broken anything yesterday.</p><p>I attached a battery (I managed to find another LiPo battery buried in a drawer), checked output voltage (5.1V ☑️), wired up the raspberry pi (which booted.) Everything seems to work as well as it did two days ago. However, I tested a few things that I hadn't tested before, and discovered a few unfortunate things:</p><p>When I plugged in the USB charge cable, the red LED on the Raspberry Pi shut off. However, the Pi didn't actually shut down - I think the input voltage dropped just enough that the Pi turned off the LED. (The USB charger I'm testing with only puts out about 4.5V.)</p><p>However, when I unplugged the USB cable, the Pi did actually shut off. Turns out, it takes about 38ms for the bq25895 to start the boost converter after VBUS drops to 0, so my 5V output drops to about 0.2V below Vbat, so about 3.6V in this case. (probably being fed entirely through the external Schottky diode.)</p><p><span></span></p><figure><img src="/img/pipad/6454821625722080971.png"/><figcaption>Screenshot of Logic 2 showing the voltage drop on the 5V output when you unplug the USB input cable.</figcaption></figure><p>From this trace of the various voltage rails, we can see that PMID (the 5v output of the bq25895) and 5V @ pi (the pi's 5v rail, connected by wire to PMID - I just wanted to make sure there wasn't too much voltage drop on the wire) drop down to about 3.6V. This is low enough that the Pi shuts down its 3.3V rail.</p><p>Because of this issue and the <a href="https://github.com/EvanKrall/pipad/issues/1">risk of USB voltage being passed directly to the Pi if the bq25895 negotiates a higher voltage</a>, I think I'm going to have to add a separate boost converter like the <a href="https://github.com/SensorsIot/SuperPower/tree/master/SuperPower-RPi">SuperPower-RPi</a> project does. (I based my bq25895 schematic heavily off of theirs.)</p><p>Thanks a ton to Seth K from the SuperPower discord for his input on this.</p>

</main>

  <footer>
  
  
  </footer>
  </body>
</html>

